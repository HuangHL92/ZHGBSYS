
function LeafCheckBoxLoadTree(sText,sXmlSrc,sAction,sBehavior,sIcon,sOpenIcon){this.WebFXTree=WebFXTree;this.WebFXTree(sText,sAction,sBehavior,sIcon,sOpenIcon);this.src=sXmlSrc;this.loading=false;this.loaded=false;this.errorText="";if(this.open)_startLoadXmlTree(this.src,this);else{this._loadingItem=new LeafCheckBoxTreeItem(webFXTreeConfig.loadingText);this.add(this._loadingItem);}};LeafCheckBoxLoadTree.prototype=new WebFXTree;LeafCheckBoxLoadTree.prototype._webfxtree_expand=WebFXTree.prototype.expand;LeafCheckBoxLoadTree.prototype.expand=function(){if(!this.loaded&&!this.loading){_startLoadXmlTree(this.src,this);}this._webfxtree_expand();};function LeafCheckBoxLoadTreeItem(sText,sXmlSrc,sAction,eParent,sIcon,sOpenIcon,nValue,sCheckBoxName){this.WebFXTreeItem=LeafCheckBoxTreeItem;this.WebFXTreeItem(sText,sAction,eParent,sIcon,sOpenIcon,nValue,sCheckBoxName);this.src=sXmlSrc;this.loading=false;this.loaded=false;this.errorText="";if(nValue==1)_startLoadXmlTree(this.src,this);else{this._loadingItem=new LeafCheckBoxTreeItem(webFXTreeConfig.loadingText);this.add(this._loadingItem);}};LeafCheckBoxLoadTreeItem.prototype=new LeafCheckBoxTreeItem;LeafCheckBoxLoadTreeItem.prototype._webfxtreeitem_expand=LeafCheckBoxTreeItem.prototype.expand;LeafCheckBoxLoadTreeItem.prototype.expand=function(){if(!this.loaded&&!this.loading){_startLoadXmlTree(this.src,this);}this._webfxtreeitem_expand();};LeafCheckBoxLoadTree.prototype.reload=LeafCheckBoxLoadTreeItem.prototype.reload=function(){if(this.loaded){var open=this.open;while(this.childNodes.length>0)this.childNodes[this.childNodes.length-1].remove();this.loaded=false;this._loadingItem=new LeafCheckBoxTreeItem(webFXTreeConfig.loadingText);this.add(this._loadingItem);if(open)this.expand();}else if(this.open&&!this.loading)_startLoadXmlTree(this.src,this);};function _startLoadXmlTree(sSrc,jsNode){if(jsNode.loading||jsNode.loaded)return;jsNode.loading=true;var xmlHttp=XmlHttp.create();xmlHttp.open("GET",sSrc,true);xmlHttp.onreadystatechange=function(){if(xmlHttp.readyState==4){_xmlFileLoaded(xmlHttp.responseXML,jsNode);}};window.setTimeout(function(){xmlHttp.send(null);},10);};function _xmlTreeToJsTree(oNode,jsParentNode){var text=oNode.getAttribute("text");var action=oNode.getAttribute("action");var nodeValue=oNode.getAttribute("value");var codeValue=oNode.getAttribute("code");var parent=null;var icon=oNode.getAttribute("icon");var openIcon=oNode.getAttribute("openIcon");var src=oNode.getAttribute("src");var target=oNode.getAttribute("target");var jsNode;var parentNodeValue=jsParentNode._checkBox.value;if(src!=null&&src!="")if(parentNodeValue!=1){jsNode=new LeafCheckBoxLoadTreeItem(text,src,action,parent,icon,openIcon,jsParentNode._checkBox.value,codeValue);}else{jsNode=new LeafCheckBoxLoadTreeItem(text,src,action,parent,icon,openIcon,nodeValue,codeValue);}else if(parentNodeValue!=1){jsNode=new LeafCheckBoxTreeItem(text,action,parent,icon,openIcon,jsParentNode._checkBox.value,codeValue);}else{jsNode=new LeafCheckBoxTreeItem(text,action,parent,icon,openIcon,nodeValue,codeValue);}if(target!="")jsNode.target=target;var cs=oNode.childNodes;var l=cs.length;for(var i=0;i<l;i++){if(cs[i].tagName=="tree")jsNode.add(_xmlTreeToJsTree(cs[i],jsParentNode),true);};return jsNode;};function _xmlFileLoaded(oXmlDoc,jsParentNode){if(jsParentNode.loaded)return;var bIndent=false;var bAnyChildren=false;jsParentNode.loaded=true;jsParentNode.loading=false;if(oXmlDoc==null||oXmlDoc.documentElement==null){jsParentNode.errorText=parseTemplateString(webFXTreeConfig.loadErrorTextTemplate,jsParentNode.src);}else{var root=oXmlDoc.documentElement;var cs=root.childNodes;var l=cs.length;for(var i=0;i<l;i++){if(cs[i].tagName=="tree"){bAnyChildren=true;bIndent=true;jsParentNode.add(_xmlTreeToJsTree(cs[i],jsParentNode),true);}}if(!bAnyChildren)jsParentNode.errorText=parseTemplateString(webFXTreeConfig.emptyErrorTextTemplate,jsParentNode.src);}if(jsParentNode._loadingItem!=null){jsParentNode._loadingItem.remove();bIndent=true;}if(bIndent){jsParentNode.indent();}if(jsParentNode.errorText!="")window.status=jsParentNode.errorText;};function parseTemplateString(sTemplate){var args=arguments;var s=sTemplate;s=s.replace(/\%\%/g,"%");for(var i=1;i<args.length;i++)s=s.replace(new RegExp("\%"+i+"\%","g"),args[i]);return s;};